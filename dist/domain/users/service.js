"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
class UserService {
    constructor(db) {
        this.db = db;
    }
    async create(data) {
        try {
            data.password = md5(data.password);
            // проверка наличия пользователя с таким же адресом электронной почты
            const existingGmail = await this.db.userRepo.findOne({
                email: data.email,
            });
            if (existingGmail)
                throw UserException.Duplicate(data);
            // предоставить необходимую информацию
            data.roleId = "f5719d17-fcd5-42ea-b05f-99e5052ff6db";
            data.type = USER_ENUM.USER;
            // создание нового пользователя
            const result = await this.db.userRepo.create(data);
            // вернуть информацию
            return result;
        }
        catch (error) {
            throw error;
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9kb21haW4vdXNlcnMvc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUVBLE1BQU0sV0FBVztJQUNmLFlBQTZCLEVBQW1CO1FBQW5CLE9BQUUsR0FBRixFQUFFLENBQWlCO0lBQUcsQ0FBQztJQUVwRCxLQUFLLENBQUMsTUFBTSxDQUFDLElBQUk7UUFDZixJQUFJLENBQUM7WUFFSCxJQUFJLENBQUMsUUFBUSxHQUFHLEdBQUcsQ0FBRSxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7WUFFcEMscUVBQXFFO1lBQ3JFLE1BQU0sYUFBYSxHQUFHLE1BQU0sSUFBSSxDQUFDLEVBQUUsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDO2dCQUNuRCxLQUFLLEVBQUUsSUFBSSxDQUFDLEtBQUs7YUFDbEIsQ0FBQyxDQUFDO1lBQ0gsSUFBSSxhQUFhO2dCQUFFLE1BQU0sYUFBYSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUV2RCxzQ0FBc0M7WUFDdEMsSUFBSSxDQUFDLE1BQU0sR0FBRyxzQ0FBc0MsQ0FBQztZQUNyRCxJQUFJLENBQUMsSUFBSSxHQUFHLFNBQVMsQ0FBQyxJQUFJLENBQUM7WUFFM0IsK0JBQStCO1lBQy9CLE1BQU0sTUFBTSxHQUFHLE1BQU0sSUFBSSxDQUFDLEVBQUUsQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBRW5ELHFCQUFxQjtZQUNyQixPQUFPLE1BQU0sQ0FBQztRQUNoQixDQUFDO1FBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztZQUNmLE1BQU0sS0FBSyxDQUFDO1FBQ2QsQ0FBQztJQUNILENBQUM7Q0FDRiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IElEQlJlcG9zaXRvcmllcyB9IGZyb20gXCIuLi8uLi9kYi9kYi1pbnRlcmZhY2VcIjtcclxuXHJcbmNsYXNzIFVzZXJTZXJ2aWNlIHtcclxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlYWRvbmx5IGRiOiBJREJSZXBvc2l0b3JpZXMpIHt9XHJcblxyXG4gIGFzeW5jIGNyZWF0ZShkYXRhKSB7XHJcbiAgICB0cnkge1xyXG4gICAgXHJcbiAgICAgIGRhdGEucGFzc3dvcmQgPSBtZDUgKGRhdGEucGFzc3dvcmQpO1xyXG5cclxuICAgICAgLy8g0L/RgNC+0LLQtdGA0LrQsCDQvdCw0LvQuNGH0LjRjyDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y8g0YEg0YLQsNC60LjQvCDQttC1INCw0LTRgNC10YHQvtC8INGN0LvQtdC60YLRgNC+0L3QvdC+0Lkg0L/QvtGH0YLRi1xyXG4gICAgICBjb25zdCBleGlzdGluZ0dtYWlsID0gYXdhaXQgdGhpcy5kYi51c2VyUmVwby5maW5kT25lKHtcclxuICAgICAgICBlbWFpbDogZGF0YS5lbWFpbCxcclxuICAgICAgfSk7XHJcbiAgICAgIGlmIChleGlzdGluZ0dtYWlsKSB0aHJvdyBVc2VyRXhjZXB0aW9uLkR1cGxpY2F0ZShkYXRhKTtcclxuXHJcbiAgICAgIC8vINC/0YDQtdC00L7RgdGC0LDQstC40YLRjCDQvdC10L7QsdGF0L7QtNC40LzRg9GOINC40L3RhNC+0YDQvNCw0YbQuNGOXHJcbiAgICAgIGRhdGEucm9sZUlkID0gXCJmNTcxOWQxNy1mY2Q1LTQyZWEtYjA1Zi05OWU1MDUyZmY2ZGJcIjtcclxuICAgICAgZGF0YS50eXBlID0gVVNFUl9FTlVNLlVTRVI7XHJcblxyXG4gICAgICAvLyDRgdC+0LfQtNCw0L3QuNC1INC90L7QstC+0LPQviDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y9cclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5kYi51c2VyUmVwby5jcmVhdGUoZGF0YSk7XHJcblxyXG4gICAgICAvLyDQstC10YDQvdGD0YLRjCDQuNC90YTQvtGA0LzQsNGG0LjRjlxyXG4gICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiJdfQ==